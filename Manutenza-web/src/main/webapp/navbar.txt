<script type="text/javascript">

	$(document).ready(function () {

		var pathname = window.location.pathname;
		
		var getUrlParameter = function getUrlParameter(sParam) {
		    var sPageURL = decodeURIComponent(window.location.search.substring(1));
		    var sURLVariables = sPageURL.split('&');
		    var sParameterName;
		    var i;
		    
		    for (i = 0; i < sURLVariables.length; i++) {
			sParameterName = sURLVariables[i].split('=');

			if (sParameterName[0] === sParam) {
			    return sParameterName[1] === undefined ? true : sParameterName[1];
			}
		    }
		};

		//pagina home all'avvio dell'app o dopo il login
		if(getUrlParameter('action') === undefined || getUrlParameter('action') === 'logout'){
		    var path = pathname + "?action=home";
		}
		else {
		    var path = pathname + "?action=" + getUrlParameter('action');
		}
		
		//voci di sotto menu
		if($('.nav > li > a[href="'+path+'"]').length === 0){
		    //console.log($('.dropdown-menu > li > a[href="'+path+'"]'));
		    $('.dropdown-menu > li > a[href="'+path+'"]').parent().addClass('active');
		}
		//voci della navbar
		else {
		    //console.log($('.nav > li > a[href="'+path+'"]'));
		    $('.nav > li > a[href="'+path+'"]').parent().addClass('active'); 
		}

	});

</script>
		
		
<!-------------------- NAVIGATION BAR -------------------->
<nav id=topNav" class="navbar navbar-default navbar-fixed-top">
	<div class="container-fluid">
		<!-- NAVIGATION HEADER -->
		<div class="navbar-header">
			<!-- bottone di collapse (appare solo per finestre piccole) -->
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="fa fa-bars fa-2x" aria-hidden="true"></span> 
			</button>
			<a class="navbar-brand" href="#">ManUtenza</a>
		</div>

		<!-- MAIN NAVBAR -->
		<div class="navbar-collapse collapse" id="myNavbar">
		<%
				//utente loggato
				if(session.getAttribute("email")!=null) { %>
					<ul class="nav navbar-nav">
						<li><a href="/Manutenza-web/MainController?action=dashboard">Dashboard</a></li>
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Le mie richieste <span class="caret"></span></a>
							<ul class="dropdown-menu">
								<li><a href="/Manutenza-web/MainController?action=nuovaRichiesta">Nuova richiesta</a></li>
								<li><a href="/Manutenza-web/MainController?action=richiesteInCorso">In corso</a></li>
								<li><a href="/Manutenza-web/MainController?action=richiestePassate">Passate</a></li>
							</ul>
						</li>
						<li><a href="/Manutenza-web/MainController?action=competenze">Le mie competenze</a></li>
						<li class="dropdown">
							<a class=dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Proposte di lavoro <span class="caret"></span></a>
							<ul class="dropdown-menu">
								<li><a href="/Manutenza-web/MainController?action=nuoveProposte">Nuove proposte</a></li>
								<li><a href="/Manutenza-web/MainController?action=proposteAccettate">Accettate</a></li>
								<li><a href="/Manutenza-web/MainController?action=lavoriCompletati">Completate</a></li>
							</ul>
						</li>
					</ul>
				<%}
			%>
				
			<!-- RIGHT-SIDE NAVBAR -->
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="/Manutenza-web/MainController?action=contatti">
						<div class="hidden-sm"><span class="glyphicon glyphicon-info-sign"></span> Contatti</div>
						<span class="glyphicon glyphicon-info-sign visible-sm"</span>
					</a>
				</li>
				<%
					//utente loggato
					if(session.getAttribute("email")!=null) { %>
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
							<span class="fa fa-user"></span><span class="caret"></span>
						</a>
						<ul class="dropdown-menu dropdown-account">
							<li>
								<div class="container-fluid account-data">
									<div class="row">
										<div class="col-xs-4">
											<img class="profile-img-mini" src="images/profile_img.png" alt="profile-img"/>
										</div>
										<div class="col-xs-8">
											<p><b>Nome Account</b></p>
											<p>example@mail.it</p>
											<a class="profile-link" href="/Manutenza-web/MainController?action=profilo">Profilo</a>
										</div>
									</div>
								</div>
							</li>
							<li role="separator" class="divider"></li>
							<li><a href="#"><i class="fa fa-sign-out" aria-hidden="true"></i> Logout</a></li>
						</ul>
					</li>
					<%}
					//utente non loggato
					else {
						//mostra bottone login FB
					}
				%>
			</ul>
		</div>
	</div>
</nav>